Document   : IDCSTATUSVIEWREPORT
Created on : OCT 21, 2024
Author     : PUNITH K V


SELECT * FROM INTERNALDOCUMENT WHERE PROVISIONALCOUNTERCODE='RTN'
SELECT * FROM INTERNALDOCUMENTLINE
SELECT * FROM ORDERPARTNER
SELECT * FROM BUSINESSPARTNER

SELECT I.DIVISIONCODE,I.PROVISIONALCOUNTERCODE,I.PROVISIONALCODE,I.PROVISIONALDOCUMENTDATE,B.LEGALNAME1,
IL.ITEMTYPEAFICODE,IL.ITEMDESCRIPTION,IL.BASEPRIMARYUOMCODE,IL.USERPRIMARYQUANTITY,IL.COST,IL.SHIPPEDUSERPRIMARYQUANTITY,
IL.SHIPPEDUSERPRIMARYQUANTITY*IL.COST TOTAL_SHIPPED_COST,IL.USERPRIMARYQUANTITY-IL.SHIPPEDUSERPRIMARYQUANTITY BALANCE_TO_SHIP,
IL.RECEIVEDUSERPRIMARYQUANTITY,IL.SHIPPEDUSERPRIMARYQUANTITY-IL.RECEIVEDUSERPRIMARYQUANTITY BALANCE_TO_RECEIPT,IL.CREATIONUSER,
CASE
WHEN IL.PROGRESSSTATUS=0 THEN 'ENTERED'
WHEN IL.PROGRESSSTATUS=1 THEN 'ARTIALLY SHIPPED'
ELSE 'CLOSED'
END AS STATUS
FROM INTERNALDOCUMENT I,INTERNALDOCUMENTLINE IL,ORDERPARTNER O,BUSINESSPARTNER B
WHERE I.DIVISIONCODE='105' AND I.PROVISIONALCOUNTERCODE='RTN' AND I.PROVISIONALDOCUMENTDATE<'2023-01-01' AND
I.PROVISIONALCODE=IL.INTDOCUMENTPROVISIONALCODE AND I.ORDPRNCUSTOMERSUPPLIERCODE=O.CUSTOMERSUPPLIERCODE AND O.ORDERBUSINESSPARTNERNUMBERID=B.NUMBERID
ORDER BY I.PROVISIONALDOCUMENTDATE DESC
